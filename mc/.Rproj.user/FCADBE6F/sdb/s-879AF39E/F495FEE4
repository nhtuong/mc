{
    "contents" : "#########################################\n# classifySubjects.R - Classify subjects\n# Author: Hoai Tuong Nguyen\n# Created: 30/05/2013\n# Modified: 20/06/2013\n# CMD: R --no-save --no-restore --slave -f classifySubjects.R \"--args input.dir='?' output.dir='?'\"\n#########################################\n\n#Install on cluster\n#install.packages(\"\",repos=\"http://bioconductor.org/packages/2.12/bioc\",lib=\"/home/nguyen/R\") \n\n#First read and parse the arguments for on the fly run\nargs=(commandArgs(TRUE))\n\nfor(i in 1:length(args)){\n  eval(parse(text=args[[i]]))\n}\n\n\nlibrary(mc)\n\n#default working path for inner run\n#setwd(\"MetaCARDIS/\")\n#setwd(\"C:/Users/TUONG/Documents/metacardis/7.scripts/\")\n\n#default input and output paths\nif (!exists(\"input.dir\"))\n  input.dir=\"../1.data/metacardis\"\nif (!exists(\"output.dir\"))\n  output.dir=\"../3.results/CLASSIFICATION/Subjects/2013-06-17\"\n\ndir.create(output.dir, showWarnings = FALSE)\n\n\n#Load imputed data\n#seqcount.data<-get(load(sprintf(\"%s/DonneeSequences_t0_global_counting_table.csv.gz.opt.RData\",input.dir)))\nclinic.data<-get(load(sprintf(\"%s/T0ClinicalParametersMicrObesja_All.RData\",input.dir)))\nge.data.t0<-get(load(sprintf(\"%s/GE_t0.RData\",input.dir)))\n#ge.data.t0<-read.table(sprintf(\"%s/GE_t0.csv\",output.dir),header=T,sep=\",\")\ngo.data<-get(load(sprintf(\"%s/DiogenesFunctionsPerProbeMatrix.rdata\",input.dir)))\n\nnames(which(go.data[,\"GO:0070904\"]==1))\nnames(which(go.data[8134,]==1))\n\n#Pre-processing data\nif(F){\n  clinic.data.1<-get(load(sprintf(\"%s/DonneeCliniques0_6_12Sem_3avril2010.xls.imputed.RData\",input.dir)))\n  tmp<-clinic.data[sapply(1:49, function(x) which(clinic.data$Names == clinic.data.1$NOM[x])),]\n  heigh_clin_m<-clinic.data.1$Taille[1:49]\n  names(heigh_clin_m)\n  clinic.data<-cbind(tmp[,1:5],heigh_clin_m,tmp[,6:ncol(tmp)])\n  save(clinic.data,file=sprintf(\"%s/T0ClinicalParametersMicrObesja_All.RData\",input.dir))\n  write.table(clinic.data,sprintf(\"%s/T0ClinicalParametersMicrObesja_All.csv\",input.dir),row.names=F,sep=\";\")\n  \n  \n  #Genes data\n  ge.data<-read.table(sprintf(\"%s/data.d.all.txt\",input.dir),sep=\"\\t\",header=T)\n  ge.annot.data<-read.table(sprintf(\"%s/sourceBatch236740_Entrez.txt\",input.dir),sep=\"\\t\",header=T)\n  \n  \n  \n  Probe_Id<-ge.data[-1,1]\n  Entrez_Gene_ID<-ge.data[-1,3]\n  \n  Gene_Names<-select(hgu95av2.db, Entrez_Gene_ID, \"GENENAME\", \"ENTREZID\")\n  Entrez_Gene_ID_2<-select(hgu95av2.db, Probe_Id, \"GENENAME\", \"PROBEID\")\n  #ReMOI\n  #http://remoat.sysbiol.cam.ac.uk/search.php\n  \n  #Convetion Source:\n  #http://www.shodhaka.com/cgi-bin/startbioinfo/simpleresources.pl?tn=Gene%20ID%20conversion\n  \n  \n  ge.data.t0<-as.data.frame(ge.data[-1,which(substr(names(ge.data),9,10)==\"0\")])\n  \n  ge.data.t0.names<-gsub(\".J0\", \"\", names(ge.data.t0))\n  ge.data.t0.names<-gsub(\".\", \"-\", ge.data.t0.names,fixed=TRUE)\n  colnames(ge.data.t0)<-ge.data.t0.names\n  rownames(ge.data.t0)<-Probe_Id\n  ge.data.t0<-t(ge.data.t0)\n  \n  ge.data.t0<-ge.data.t0[-27,]\n\n  \n  n.na<-sapply(1:ncol(ge.data.t0),function(x) sum(is.na(ge.data.t0[,x]))) \n  ge.data.t0.nona<-ge.data.t0[,which(n.na==0)]\n\n  save(ge.data.t0,file=sprintf(\"%s/GE_t0.RData\",input.dir))\n  \n  write.table(ge.data.t0,file=sprintf(\"%s/GE_t0.csv\",output.dir),col.names=T,row.names=F,sep=\",\",quote=F)\n  \n  write.table(unique(Entrez_Gene_ID),file=sprintf(\"%s/Entrez_Gene_ID.csv\",input.dir),col.names=F,row.names=F,sep=\",\",quote=F)\n  \n  \n  lm.classified.wfmh2.t0<-read.csv(sprintf(\"%s/lm_t0_Waist_vs_Fat-mass_Height2_points.csv\",output.dir))\n  lm.classified.adfm.t0<-read.csv(sprintf(\"%s/lm_t0_Adipocyte-diameter_vs_Fat-mass_points.csv\",output.dir))\n  lm.classified.adwh2.t0<-read.csv(sprintf(\"%s/lm_t0_Adipocyte-diameter_vs_Waist_Height2_points.csv\",output.dir))\n  lm.classified.adfmh2.t0<-read.csv(sprintf(\"%s/lm_t0_Adipocyte-diameter_vs_Fat-mass_Height2_points.csv\",output.dir))\n  lm.classified.adh2.t0<-read.csv(sprintf(\"%s/lm_t0_Adipocyte-diameter_vs_Height2_points.csv\",output.dir))\n  \n  lm.classified.adbmifma.t0<-read.csv(sprintf(\"%s/lm_t0_Adipocyte-diameter_vs_BMI-Fat-mass-Age_points.csv\",output.dir))\n  \n  lw.classified.wfmh2.t0<-read.csv(sprintf(\"%s/lw_t0_Waist_vs_Fat-mass_Height2_points.csv\",output.dir))\n  lw.classified.adfm.t0<-read.csv(sprintf(\"%s/lw_t0_Adipocyte-diameter_vs_Fat-mass_points.csv\",output.dir))\n  lw.classified.adwh2.t0<-read.csv(sprintf(\"%s/lw_t0_Adipocyte-diameter_vs_Waist_Height2_points.csv\",output.dir))\n  lw.classified.adfmh2.t0<-read.csv(sprintf(\"%s/lw_t0_Adipocyte-diameter_vs_Fat-mass_Height2_points.csv\",output.dir))\n  lw.classified.adh2.t0<-read.csv(sprintf(\"%s/lw_t0_Adipocyte-diameter_vs_Height2_points.csv\",output.dir))\n  \n  lw.classified.adbmifma.t0<-read.csv(sprintf(\"%s/lw_t0_Adipocyte-diameter_vs_BMI-Fatmass-Age_points.csv\",output.dir))\n  \n  \n  tmp<-clinic.data[sapply(1:nrow(ge.data.t0), function(x) which(clinic.data$Names == lm.classified.wfmh2.t0$Name)),]\n  \n  ge.lm.classified.wfmh2.t0<-lm.classified.wfmh2.t0[lm.classified.wfmh2.t0$Name %in% rownames(ge.data.t0),]\n  ge.lm.classified.adfm.t0<-lm.classified.adfm.t0[lm.classified.adfm.t0$Name %in% rownames(ge.data.t0),]\n  ge.lm.classified.adwh2.t0<-lm.classified.adwh2.t0[lm.classified.adwh2.t0$Name %in% rownames(ge.data.t0),]\n  ge.lm.classified.adfmh2.t0<-lm.classified.adfmh2.t0[lm.classified.adfmh2.t0$Name %in% rownames(ge.data.t0),]\n  ge.lm.classified.adh2.t0<-lm.classified.adh2.t0[lm.classified.adh2.t0$Name %in% rownames(ge.data.t0),]\n  \n  ge.lm.classified.adbmifma.t0<-lm.classified.adbmifma.t0[lm.classified.adbmifma.t0$Name %in% rownames(ge.data.t0),]\n  \n  ge.lw.classified.wfmh2.t0<-lw.classified.wfmh2.t0[lw.classified.wfmh2.t0$Name %in% rownames(ge.data.t0),]\n  ge.lw.classified.adfm.t0<-lw.classified.adfm.t0[lw.classified.adfm.t0$Name %in% rownames(ge.data.t0),]\n  ge.lw.classified.adwh2.t0<-lw.classified.adwh2.t0[lw.classified.adwh2.t0$Name %in% rownames(ge.data.t0),]\n  ge.lw.classified.adfmh2.t0<-lw.classified.adfmh2.t0[lw.classified.adfmh2.t0$Name %in% rownames(ge.data.t0),]\n  ge.lw.classified.adh2.t0<-lw.classified.adh2.t0[lw.classified.adh2.t0$Name %in% rownames(ge.data.t0),]\n  \n  ge.lw.classified.adbmifma.t0<-lw.classified.adbmifma.t0[lw.classified.adbmifma.t0$Name %in% rownames(ge.data.t0),]\n\n  \n  write.table(ge.lm.classified.wfmh2.t0,file=sprintf(\"%s/ge-nona_lm_t0_Waist_vs_Fat-mass_Height2_points.csv\",output.dir),col.names=T,row.names=F,sep=\",\",quote=F)\n  write.table(ge.lm.classified.adfm.t0,file=sprintf(\"%s/ge-nona_lm_t0_Adipocyte-diameter_vs_Fat-mass_points.csv\",output.dir),col.names=T,row.names=F,sep=\",\",quote=F)\n  write.table(ge.lm.classified.adwh2.t0,file=sprintf(\"%s/ge-nona_lm_t0_Adipocyte-diameter_vs_Waist_Height2_points.csv\",output.dir),col.names=T,row.names=F,sep=\",\",quote=F)\n  write.table(ge.lm.classified.adfmh2.t0,file=sprintf(\"%s/ge-nona_lm_t0_Adipocyte-diameter_vs_Fat-mass_Height2_points.csv\",output.dir),col.names=T,row.names=F,sep=\",\",quote=F)\n  write.table(ge.lm.classified.adh2.t0,file=sprintf(\"%s/ge-nona_lm_t0_Adipocyte-diameter_vs_Height2_points.csv\",output.dir),col.names=T,row.names=F,sep=\",\",quote=F)\n  \n  write.table(ge.lm.classified.adbmifma.t0,file=sprintf(\"%s/ge-nona_lm_t0_Adipocyte-diameter_vs_BMI-Fat-mass-Age_points.csv\",output.dir),col.names=T,row.names=F,sep=\",\",quote=F)\n  \n  write.table(ge.lw.classified.wfmh2.t0,file=sprintf(\"%s/ge-nona_lw_t0_Waist_vs_Fat-mass_Height2_points.csv\",output.dir),col.names=T,row.names=F,sep=\",\",quote=F)\n  write.table(ge.lw.classified.adfm.t0,file=sprintf(\"%s/ge-nona_lw_t0_Adipocyte-diameter_vs_Fat-mass_points.csv\",output.dir),col.names=T,row.names=F,sep=\",\",quote=F)\n  write.table(ge.lw.classified.adwh2.t0,file=sprintf(\"%s/ge-nona_lw_t0_Adipocyte-diameter_vs_Waist_Height2_points.csv\",output.dir),col.names=T,row.names=F,sep=\",\",quote=F)\n  write.table(ge.lw.classified.adfmh2.t0,file=sprintf(\"%s/ge-nona_lw_t0_Adipocyte-diameter_vs_Fat-mass_Height2_points.csv\",output.dir),col.names=T,row.names=F,sep=\",\",quote=F)\n  write.table(ge.lw.classified.adh2.t0,file=sprintf(\"%s/ge-nona_lw_t0_Adipocyte-diameter_vs_Height2_points.csv\",output.dir),col.names=T,row.names=F,sep=\",\",quote=F)\n  \n  write.table(ge.lw.classified.adbmifma.t0,file=sprintf(\"%s/ge-nona_lw_t0_Adipocyte-diameter_vs_BMI-Fat-mass-Age_points.csv\",output.dir),col.names=T,row.names=F,sep=\",\",quote=F)\n  \n  \n  \n  \n  \n}\n\n\n\n#Annotation\n#\"diam_clin\" = adipocyte diametre\n#\"tour.de.taille_clin\"= Waist\n#\"MG.kg_clin\" = Fat mas en KG (absolu)\n#\"MG.percent_clin\" = Fat mass/body weight %\n#\"Taille\"= Height\n\n\n########################################\n# PLOT CORRELATION AND ADD LOWESS LINE #\n########################################\n\nattach(clinic.data)\n\n#t0 - \"Adipocyte diameter\" vs \"Fat mass\" by LOWESS\nreg.plot.mc(fatmass_clin_kg,diam_clin_cm,\n            type=\"lowess\",\n            pch=ifelse(Sexe==\"M\", 0, 1),         \n            subjects=as.vector(Names),\n            title=\"CORRELATION (T0) - LOWESS\",\n            xlab=\"Fat mass\",ylab=\"Adipocyte diameter\",\n            legend.topright=list(title=\"SHAPE\",pch=c(1,0),label=c(\"Female\",\"Male\"),col=c(\"black\",\"black\")),\n            imgfile=sprintf(\"%s/lw_t0_Adipocyte-diameter_vs_Fat-mass.pdf\",output.dir),\n            pointsfile=sprintf(\"%s/lw_t0_Adipocyte-diameter_vs_Fat-mass_points.csv\",output.dir))\n\n#t0 - \"Waist\" vs \"Fat mass/Height*Height\" by LOWESS\nx=fatmass_clin_kg/(heigh_clin_m*heigh_clin_m)\nreg.plot.mc(x,waist.circumference_clin_cm,\n            type=\"lowess\",\n            pch=ifelse(Sexe==\"M\", 0, 1),\n            subjects=as.vector(Names),\n            title=\"CORRELATION (T0) - LOWESS\",\n            xlab=\"Fat mass/Height*Height\",ylab=\"Waist\",\n            legend.topright=list(title=\"SHAPE\",pch=c(1,0),label=c(\"Female\",\"Male\"),col=c(\"black\",\"black\")),\n            imgfile=sprintf(\"%s/lw_t0_Waist_vs_Fat-mass_Height2.pdf\",output.dir),\n            pointsfile=sprintf(\"%s/lw_t0_Waist_vs_Fat-mass_Height2_points.csv\",output.dir))\n\n\n\n#t0 - \"Adipocyte diameter\" vs \"Waist/Height*Height\" by LOWESS\nx=waist.circumference_clin_cm/(heigh_clin_m*heigh_clin_m)\nreg.plot.mc(x,diam_clin_cm,\n            type=\"lowess\",\n            pch=ifelse(Sexe==\"M\", 0, 1),\n            subjects=as.vector(Names),\n            title=\"CORRELATION (T0) - LOWESS\",\n            xlab=\"Waist/Height*Height\",ylab=\"Adipocyte diameter\",\n            legend.topleft=list(title=\"SHAPE\",pch=c(1,0),label=c(\"Female\",\"Male\"),col=c(\"black\",\"black\")),\n            imgfile=sprintf(\"%s/lw_t0_Adipocyte-diameter_vs_Waist_Height2.pdf\",output.dir),\n            pointsfile=sprintf(\"%s/lw_t0_Adipocyte-diameter_vs_Waist_Height2_points.csv\",output.dir))\n\n\n#t0 - \"Adipocyte diameter\" vs \"Fat mass/Height*Height\" by LOWESS\nx=fatmass_clin_kg/(heigh_clin_m*heigh_clin_m)\nreg.plot.mc(x,diam_clin_cm,\n            type=\"lowess\",\n            pch=ifelse(Sexe==\"M\", 0, 1),\n            subjects=as.vector(Names),\n            title=\"CORRELATION (T0) - LOWESS\",\n            xlab=\"Fat mass/Height*Height\",ylab=\"Adipocyte diameter\",\n            legend.topleft=list(title=\"SHAPE\",pch=c(1,0),label=c(\"Female\",\"Male\"),col=c(\"black\",\"black\")),\n            imgfile=sprintf(\"%s/lw_t0_Adipocyte-diameter_vs_Fat-mass_Height2.pdf\",output.dir),\n            pointsfile=sprintf(\"%s/lw_t0_Adipocyte-diameter_vs_Fat-mass_Height2_points.csv\",output.dir))\n\n\n#t0 - \"Adipocyte diameter\" vs \"Height*Height\" by LOWESS\nx=heigh_clin_m*heigh_clin_m\nreg.plot.mc(x,diam_clin_cm,\n            type=\"lowess\",\n            pch=ifelse(Sexe==\"M\", 0, 1),\n            subjects=as.vector(Names),\n            title=\"CORRELATION (T0) - LOWESS\",\n            xlab=\"Height*Height\",ylab=\"Adipocyte diameter\",\n            legend.topleft=list(title=\"SHAPE\",pch=c(1,0),label=c(\"Female\",\"Male\"),col=c(\"black\",\"black\")),\n            imgfile=sprintf(\"%s/lw_t0_Adipocyte-diameter_vs_Height2.pdf\",output.dir),\n            pointsfile=sprintf(\"%s/lw_t0_Adipocyte-diameter_vs_Height2_points.csv\",output.dir))\n\n\n#t0 - \"Adipocyte diameter\" vs \"BMI~fatmass~Age\" by LOWESS\nx1<-fitted(loess(clinic.data$BMI_clin_kg.per.m~clinic.data$fatmass_clin_kg))\nx<-fitted(loess(x1~clinic.data$Age_years))\nreg.plot.mc(x,diam_clin_cm,\n            type=\"lowess\",\n            pch=ifelse(Sexe==\"M\", 0, 1),\n            subjects=as.vector(Names),\n            title=\"CORRELATION (T0) - LOWESS\",\n            xlab=\"BMI~fatmass~Age\",ylab=\"Adipocyte diameter\",\n            legend.topleft=list(title=\"SHAPE\",pch=c(1,0),label=c(\"Female\",\"Male\"),col=c(\"black\",\"black\")),\n            imgfile=sprintf(\"%s/lw_t0_Adipocyte-diameter_vs_BMI-fatmass-Age.pdf\",output.dir),\n            pointsfile=sprintf(\"%s/lw_t0_Adipocyte-diameter_vs_BMI-fatmass-Age_points.csv\",output.dir))\n\n\n\n########################################\n# PLOT CORRELATION AND ADD LINEAR LINE #\n########################################\n\n\n#t0 - \"Adipocyte diameter\" vs \"Fat mass\" by Linear Regression\nreg.plot.mc(fatmass_clin_kg,diam_clin_cm,\n            type=\"lm\",\n            pch=ifelse(Sexe==\"M\", 0, 1),         \n            subjects=as.vector(Names),\n            title=\"CORRELATION (T0) - Linear Regression\",\n            xlab=\"Fat mass\",ylab=\"Adipocyte diameter\",\n            legend.topright=list(title=\"SHAPE\",pch=c(1,0),label=c(\"Female\",\"Male\"),col=c(\"black\",\"black\")),\n            imgfile=sprintf(\"%s/lm_t0_Adipocyte-diameter_vs_Fat-mass.pdf\",output.dir),\n            pointsfile=sprintf(\"%s/lm_t0_Adipocyte-diameter_vs_Fat-mass_points.csv\",output.dir))\n\n#t0 - \"Waist\" vs \"Fat mass/Height*Height\" by Linear Regression\nx=fatmass_clin_kg/(heigh_clin_m*heigh_clin_m)\nreg.plot.mc(x,waist.circumference_clin_cm,\n            type=\"lm\",\n            pch=ifelse(Sexe==\"M\", 0, 1),\n            subjects=as.vector(Names),\n            title=\"CORRELATION (T0) - Linear Regression\",\n            xlab=\"Fat mass/Height*Height\",ylab=\"Waist\",\n            legend.topright=list(title=\"SHAPE\",pch=c(1,0),label=c(\"Female\",\"Male\"),col=c(\"black\",\"black\")),\n            imgfile=sprintf(\"%s/lm_t0_Waist_vs_Fat-mass_Height2.pdf\",output.dir),\n            pointsfile=sprintf(\"%s/lm_t0_Waist_vs_Fat-mass_Height2_points.csv\",output.dir))\n\n\n\n#t0 - \"Adipocyte diameter\" vs \"Waist/Height*Height\" by Linear Regression\nx=waist.circumference_clin_cm/(heigh_clin_m*heigh_clin_m)\nreg.plot.mc(x,diam_clin_cm,\n            type=\"lm\",\n            pch=ifelse(Sexe==\"M\", 0, 1),\n            subjects=as.vector(Names),\n            title=\"CORRELATION (T0) - Linear Regression\",\n            xlab=\"Waist/Height*Height\",ylab=\"Adipocyte diameter\",\n            legend.topleft=list(title=\"SHAPE\",pch=c(1,0),label=c(\"Female\",\"Male\"),col=c(\"black\",\"black\")),\n            imgfile=sprintf(\"%s/lm_t0_Adipocyte-diameter_vs_Waist_Height2.pdf\",output.dir),\n            pointsfile=sprintf(\"%s/lm_t0_Adipocyte-diameter_vs_Waist_Height2_points.csv\",output.dir))\n\n\n\n\n#t0 - \"Adipocyte diameter\" vs \"Fat mass/Height*Height\" by Linear Regression\nx=fatmass_clin_kg/(heigh_clin_m*heigh_clin_m)\nreg.plot.mc(x,diam_clin_cm,\n            type=\"lm\",\n            pch=ifelse(Sexe==\"M\", 0, 1),\n            subjects=as.vector(Names),\n            title=\"CORRELATION (T0) - Linear Regression\",\n            xlab=\"Fat mass/Height*Height\",ylab=\"Adipocyte diameter\",\n            legend.topleft=list(title=\"SHAPE\",pch=c(1,0),label=c(\"Female\",\"Male\"),col=c(\"black\",\"black\")),\n            imgfile=sprintf(\"%s/lm_t0_Adipocyte-diameter_vs_Fat-mass_Height2.pdf\",output.dir),\n            pointsfile=sprintf(\"%s/lm_t0_Adipocyte-diameter_vs_Fat-mass_Height2_points.csv\",output.dir))\n\n#t0 - \"Adipocyte diameter\" vs \"Height*Height\" by Linear Regression\nx=heigh_clin_m*heigh_clin_m\nreg.plot.mc(x,diam_clin_cm,\n            type=\"lm\",\n            pch=ifelse(Sexe==\"M\", 0, 1),\n            subjects=as.vector(Names),\n            title=\"CORRELATION (T0) - Linear Regression\",\n            xlab=\"Height*Height\",ylab=\"Adipocyte diameter\",\n            legend.topleft=list(title=\"SHAPE\",pch=c(1,0),label=c(\"Female\",\"Male\"),col=c(\"black\",\"black\")),\n            imgfile=sprintf(\"%s/lm_t0_Adipocyte-diameter_vs_Height2.pdf\",output.dir),\n            pointsfile=sprintf(\"%s/lm_t0_Adipocyte-diameter_vs_Height2_points.csv\",output.dir))\n\n\n\n#t0 - \"Adipocyte diameter\" vs \"BMI~fatmass\" by Linear Regression\nx<-fitted(loess(clinic.data$BMI_clin_kg.per.m~clinic.data$fatmass_clin_kg))\nreg.plot.mc(x,diam_clin_cm,\n            type=\"lm\",\n            pch=ifelse(Sexe==\"M\", 0, 1),\n            subjects=as.vector(Names),\n            title=\"CORRELATION (T0) - Linear Regression\",\n            xlab=\"BMI~fatmass\",ylab=\"Adipocyte diameter\",\n            legend.topleft=list(title=\"SHAPE\",pch=c(1,0),label=c(\"Female\",\"Male\"),col=c(\"black\",\"black\")),\n            imgfile=sprintf(\"%s/lm_t0_Adipocyte-diameter_vs_BMI-Fat-mass.pdf\",output.dir),\n            pointsfile=sprintf(\"%s/lm_t0_Adipocyte-diameter_vs_BMI-Fat-mass_points.csv\",output.dir))\n\n\n#t0 - \"Adipocyte diameter\" vs \"BMI~fatmass\" by Linear Regression\nx1<-fitted(loess(clinic.data$BMI_clin_kg.per.m~clinic.data$fatmass_clin_kg))\nx<-fitted(loess(x1~clinic.data$Age_years))\nreg.plot.mc(x,diam_clin_cm,\n            type=\"lm\",\n            pch=ifelse(Sexe==\"M\", 0, 1),\n            subjects=as.vector(Names),\n            title=\"CORRELATION (T0) - Linear Regression\",\n            xlab=\"BMI~fatmass~Age\",ylab=\"Adipocyte diameter\",\n            legend.topleft=list(title=\"SHAPE\",pch=c(1,0),label=c(\"Female\",\"Male\"),col=c(\"black\",\"black\")),\n            imgfile=sprintf(\"%s/lm_t0_Adipocyte-diameter_vs_BMI-Fat-mass-Age.pdf\",output.dir),\n            pointsfile=sprintf(\"%s/lm_t0_Adipocyte-diameter_vs_BMI-Fat-mass-Age_points.csv\",output.dir))\n\n\n\n########################################################\n# BOXPLOT FOR CLASSIFIED GROUPS WITH LINEAR REGRESSION #\n########################################################\n\nlm.classified.wfmh2.t0<-read.csv(sprintf(\"%s/lm_t0_Waist_vs_Fat-mass_Height2_points.csv\",output.dir))\nlm.classified.adfm.t0<-read.csv(sprintf(\"%s/lm_t0_Adipocyte-diameter_vs_Fat-mass_points.csv\",output.dir))\nlm.classified.adwh2.t0<-read.csv(sprintf(\"%s/lm_t0_Adipocyte-diameter_vs_Waist_Height2_points.csv\",output.dir))\nlm.classified.adfmh2.t0<-read.csv(sprintf(\"%s/lm_t0_Adipocyte-diameter_vs_Fat-mass_Height2_points.csv\",output.dir))\n\nlm.classified.adbmifm.t0<-read.csv(sprintf(\"%s/lm_t0_Adipocyte-diameter_vs_BMI-Fat-mass_points.csv\",output.dir))\nlm.classified.adbmifma.t0<-read.csv(sprintf(\"%s/lm_t0_Adipocyte-diameter_vs_BMI-Fat-mass-Age_points.csv\",output.dir))\n\npdf(sprintf(\"%s/lm_t0_Waist_vs_Fat-mass_Height2_t-test_boxplot.pdf\",output.dir))\noutfile=sprintf(\"%s/lm_t0_Waist_vs_Fat-mass_Height2_t-test.csv\",output.dir)\npar(mfrow = c(4, 4))\nlapply(c(3,5:ncol(clinic.data)),function(x) boxplot.class.mc(data=clinic.data,x,type=\"t\",class=lm.classified.wfmh2.t0[,4],xlab=\"Risk (0=low, 1=high)\",outfile=outfile))\ndev.off()\n\n\n\npdf(sprintf(\"%s/lm_t0_Adipocyte-diameter_vs_Fat-mass_t-test_boxplot.pdf\",output.dir))\noutfile<-sprintf(\"%s/lm_t0_Adipocyte-diameter_vs_Fat-mass_t-test.csv\",output.dir)\npar(mfrow = c(4, 4))\nlapply(c(3,5:ncol(clinic.data)),function(x) boxplot.class.mc(data=clinic.data,x,type=\"t\",class=lm.classified.adfm.t0[,4],xlab=\"Risk (0=low, 1=high)\",outfile=outfile))\ndev.off()\n\n\n\npdf(sprintf(\"%s/lm_t0_Adipocyte-diameter_vs_Waist_Height2_t-test_boxplot.pdf\",output.dir))\noutfile<-sprintf(\"%s/lm_t0_Adipocyte-diameter_vs_Waist_Height2_t-test.csv\",output.dir)\npar(mfrow = c(4, 4))\nlapply(c(3,5:ncol(clinic.data)),function(x) boxplot.class.mc(data=clinic.data,x,type=\"t\",class=lm.classified.adwh2.t0[,4],xlab=\"Risk (0=low, 1=high)\",outfile=outfile))\ndev.off()\n\n\n\npdf(sprintf(\"%s/lm_t0_Adipocyte-diameter_vs_Fat-mass_Height2_t-test_boxplot.pdf\",output.dir))\noutfile<-sprintf(\"%s/lm_t0_Adipocyte-diameter_vs_Fat-mass_Height2_t-test.csv\",output.dir)\npar(mfrow = c(4, 4))\nlapply(c(3,5:ncol(clinic.data)),function(x) boxplot.class.mc(data=clinic.data,x,type=\"t\",class=lm.classified.adfmh2.t0[,4],xlab=\"Risk (0=low, 1=high)\",outfile=outfile))\ndev.off()\n\n\n\npdf(sprintf(\"%s/lm_t0_Adipocyte-diameter_vs_Height2_t-test_boxplot.pdf\",output.dir))\noutfile<-sprintf(\"%s/lm_t0_Adipocyte-diameter_vs_Height2_t-test.csv\",output.dir)\npar(mfrow = c(4, 4))\nlapply(c(3,5:ncol(clinic.data)),function(x) boxplot.class.mc(data=clinic.data,x,type=\"t\",class=lm.classified.adh2.t0[,4],xlab=\"Risk (0=low, 1=high)\",outfile=outfile))\ndev.off()\n\n\n\n\npdf(sprintf(\"%s/lm_t0_Adipocyte-diameter_vs_BMI-Fat-mass_t-test_boxplot.pdf\",output.dir))\noutfile<-sprintf(\"%s/lm_t0_Adipocyte-diameter_vs_BMI-Fat-mass_t-test.csv\",output.dir)\npar(mfrow = c(4, 4))\nlapply(c(3,5:ncol(clinic.data)),function(x) boxplot.class.mc(data=clinic.data,x,type=\"t\",class=lm.classified.adbmifm.t0[,4],xlab=\"Risk (0=low, 1=high)\",outfile=outfile))\ndev.off()\n\n\n\n\n\n\n\n\n\n\npdf(sprintf(\"%s/lm_t0_Waist_vs_Fat-mass_Height2_mwu-test_boxplot.pdf\",output.dir))\noutfile=sprintf(\"%s/lm_t0_Waist_vs_Fat-mass_Height2_mwu-test.csv\",output.dir)\npar(mfrow = c(4, 4))\nlapply(c(3,5:ncol(clinic.data)),function(x) boxplot.class.mc(data=clinic.data,x,type=\"mwu\",class=lm.classified.wfmh2.t0[,4],xlab=\"Risk (0=low, 1=high)\",outfile=outfile))\ndev.off()\n\n\n\npdf(sprintf(\"%s/lm_t0_Adipocyte-diameter_vs_Fat-mass_mwu-test_boxplot.pdf\",output.dir))\noutfile<-sprintf(\"%s/lm_t0_Adipocyte-diameter_vs_Fat-mass_mwu-test.csv\",output.dir)\npar(mfrow = c(4, 4))\nlapply(c(3,5:ncol(clinic.data)),function(x) boxplot.class.mc(data=clinic.data,x,type=\"mwu\",class=lm.classified.adfm.t0[,4],xlab=\"Risk (0=low, 1=high)\",outfile=outfile))\ndev.off()\n\n\n\npdf(sprintf(\"%s/lm_t0_Adipocyte-diameter_vs_Waist_Height2_mwu-test_boxplot.pdf\",output.dir))\noutfile<-sprintf(\"%s/lm_t0_Adipocyte-diameter_vs_Waist_Height2_mwu-test.csv\",output.dir)\npar(mfrow = c(4, 4))\nlapply(c(3,5:ncol(clinic.data)),function(x) boxplot.class.mc(data=clinic.data,x,type=\"mwu\",class=lm.classified.adwh2.t0[,4],xlab=\"Risk (0=low, 1=high)\",outfile=outfile))\ndev.off()\n\n\n\npdf(sprintf(\"%s/lm_t0_Adipocyte-diameter_vs_Fat-mass_Height2_mwu-test_boxplot.pdf\",output.dir))\noutfile<-sprintf(\"%s/lm_t0_Adipocyte-diameter_vs_Fat-mass_Height2_mwu-test.csv\",output.dir)\npar(mfrow = c(4, 4))\nlapply(c(3,5:ncol(clinic.data)),function(x) boxplot.class.mc(data=clinic.data,x,type=\"mwu\",class=lm.classified.adfmh2.t0[,4],xlab=\"Risk (0=low, 1=high)\",outfile=outfile))\ndev.off()\n\n\n\n\n\n\n\n\n\n\n\n\npdf(sprintf(\"%s/lm_t0_Waist_vs_Fat-mass_Height2_auto-test_boxplot.pdf\",output.dir))\noutfile=sprintf(\"%s/lm_t0_Waist_vs_Fat-mass_Height2_auto-test.csv\",output.dir)\npar(mfrow = c(4, 4))\nlapply(c(3,5:ncol(clinic.data)),function(x) boxplot.class.mc(data=clinic.data,x,type=\"auto\",class=lm.classified.wfmh2.t0[,4],xlab=\"Risk (0=low, 1=high)\",outfile=outfile))\ndev.off()\n\n\n\npdf(sprintf(\"%s/lm_t0_Adipocyte-diameter_vs_Fat-mass_auto-test_boxplot.pdf\",output.dir))\noutfile<-sprintf(\"%s/lm_t0_Adipocyte-diameter_vs_Fat-mass_auto-test.csv\",output.dir)\npar(mfrow = c(4, 4))\nlapply(c(3,5:ncol(clinic.data)),function(x) boxplot.class.mc(data=clinic.data,x,type=\"auto\",class=lm.classified.adfm.t0[,4],xlab=\"Risk (0=low, 1=high)\",outfile=outfile))\ndev.off()\n\n\n\npdf(sprintf(\"%s/lm_t0_Adipocyte-diameter_vs_Waist_Height2_auto-test_boxplot.pdf\",output.dir))\noutfile<-sprintf(\"%s/lm_t0_Adipocyte-diameter_vs_Waist_Height2_auto-test.csv\",output.dir)\npar(mfrow = c(4, 4))\nlapply(c(3,5:ncol(clinic.data)),function(x) boxplot.class.mc(data=clinic.data,x,type=\"auto\",class=lm.classified.adwh2.t0[,4],xlab=\"Risk (0=low, 1=high)\",outfile=outfile))\ndev.off()\n\n\n\npdf(sprintf(\"%s/lm_t0_Adipocyte-diameter_vs_Fat-mass_Height2_auto-test_boxplot.pdf\",output.dir))\noutfile<-sprintf(\"%s/lm_t0_Adipocyte-diameter_vs_Fat-mass_Height2_auto-test.csv\",output.dir)\npar(mfrow = c(4, 4))\nlapply(c(3,5:ncol(clinic.data)),function(x) boxplot.class.mc(data=clinic.data,x,type=\"auto\",class=lm.classified.adfmh2.t0[,4],xlab=\"Risk (0=low, 1=high)\",outfile=outfile))\ndev.off()\n\npdf(sprintf(\"%s/lm_t0_Adipocyte-diameter_vs_Height2_auto-test_boxplot.pdf\",output.dir))\noutfile<-sprintf(\"%s/lm_t0_Adipocyte-diameter_vs_Height2_auto-test.csv\",output.dir)\npar(mfrow = c(4, 4))\nlapply(c(3,5:ncol(clinic.data)),function(x) boxplot.class.mc(data=clinic.data,x,type=\"auto\",class=lm.classified.adh2.t0[,4],xlab=\"Risk (0=low, 1=high)\",outfile=outfile))\ndev.off()\n\n\npdf(sprintf(\"%s/lm_t0_Adipocyte-diameter_vs_BMI-Fat-mass-Age_auto-test_boxplot.pdf\",output.dir))\noutfile<-sprintf(\"%s/lm_t0_Adipocyte-diameter_vs_BMI-Fat-mass-Age_auto-test.csv\",output.dir)\npar(mfrow = c(4, 4))\nlapply(c(3,5:ncol(clinic.data)),function(x) boxplot.class.mc(data=clinic.data,x,type=\"auto\",class=lm.classified.adbmifma.t0[,4],xlab=\"Risk (0=low, 1=high)\",outfile=outfile))\ndev.off()\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n########################################################\n# BOXPLOT FOR CLASSIFIED GROUPS WITH LOWESS REGRESSION #\n########################################################\n\n\nlw.classified.wfmh2.t0<-read.csv(sprintf(\"%s/lw_t0_Waist_vs_Fat-mass_Height2_points.csv\",output.dir))\nlw.classified.adfm.t0<-read.csv(sprintf(\"%s/lw_t0_Adipocyte-diameter_vs_Fat-mass_points.csv\",output.dir))\nlw.classified.adwh2.t0<-read.csv(sprintf(\"%s/lw_t0_Adipocyte-diameter_vs_Waist_Height2_points.csv\",output.dir))\nlw.classified.adfmh2.t0<-read.csv(sprintf(\"%s/lw_t0_Adipocyte-diameter_vs_Fat-mass_Height2_points.csv\",output.dir))\n\nlw.classified.adbmifm.t0<-read.csv(sprintf(\"%s/lw_t0_Adipocyte-diameter_vs_BMI-Fatmass_points.csv\",output.dir))\nlw.classified.adbmifma.t0<-read.csv(sprintf(\"%s/lw_t0_Adipocyte-diameter_vs_BMI-Fatmass-Age_points.csv\",output.dir))\n\n\npdf(sprintf(\"%s/lw_t0_Waist_vs_Fat-mass_Height2_t-test_boxplot.pdf\",output.dir))\noutfile=sprintf(\"%s/lw_t0_Waist_vs_Fat-mass_Height2_t-test.csv\",output.dir)\npar(mfrow = c(4, 4))\nlapply(c(3,5:ncol(clinic.data)),function(x) boxplot.class.mc(data=clinic.data,x,type=\"t\",class=lw.classified.wfmh2.t0[,4],xlab=\"Risk (0=low, 1=high)\",outfile=outfile))\ndev.off()\n\n\n\npdf(sprintf(\"%s/lw_t0_Adipocyte-diameter_vs_Fat-mass_t-test_boxplot.pdf\",output.dir))\noutfile<-sprintf(\"%s/lw_t0_Adipocyte-diameter_vs_Fat-mass_t-test.csv\",output.dir)\npar(mfrow = c(4, 4))\nlapply(c(3,5:ncol(clinic.data)),function(x) boxplot.class.mc(data=clinic.data,x,type=\"t\",class=lw.classified.adfm.t0[,4],xlab=\"Risk (0=low, 1=high)\",outfile=outfile))\ndev.off()\n\n\n\npdf(sprintf(\"%s/lw_t0_Adipocyte-diameter_vs_Waist_Height2_t-test_boxplot.pdf\",output.dir))\noutfile<-sprintf(\"%s/lw_t0_Adipocyte-diameter_vs_Waist_Height2_t-test.csv\",output.dir)\npar(mfrow = c(4, 4))\nlapply(c(3,5:ncol(clinic.data)),function(x) boxplot.class.mc(data=clinic.data,x,type=\"t\",class=lw.classified.adwh2.t0[,4],xlab=\"Risk (0=low, 1=high)\",outfile=outfile))\ndev.off()\n\n\n\npdf(sprintf(\"%s/lw_t0_Adipocyte-diameter_vs_Fat-mass_Height2_t-test_boxplot.pdf\",output.dir))\noutfile<-sprintf(\"%s/lw_t0_Adipocyte-diameter_vs_Fat-mass_Height2_t-test.csv\",output.dir)\npar(mfrow = c(4, 4))\nlapply(c(3,5:ncol(clinic.data)),function(x) boxplot.class.mc(data=clinic.data,x,type=\"t\",class=lw.classified.adfmh2.t0[,4],xlab=\"Risk (0=low, 1=high)\",outfile=outfile))\ndev.off()\n\n\n\npdf(sprintf(\"%s/lw_t0_Adipocyte-diameter_vs_BMI-Fat-mass_t-test_boxplot.pdf\",output.dir))\noutfile<-sprintf(\"%s/lw_t0_Adipocyte-diameter_vs_BMI-Fat-mass_t-test.csv\",output.dir)\npar(mfrow = c(4, 4))\nlapply(c(3,5:ncol(clinic.data)),function(x) boxplot.class.mc(data=clinic.data,x,type=\"t\",class=lw.classified.adbmifm.t0[,4],xlab=\"Risk (0=low, 1=high)\",outfile=outfile))\ndev.off()\n\n\npdf(sprintf(\"%s/lw_t0_Adipocyte-diameter_vs_BMI-Fat-mass-Age_t-test_boxplot.pdf\",output.dir))\noutfile<-sprintf(\"%s/lw_t0_Adipocyte-diameter_vs_BMI-Fat-mass-Age_t-test.csv\",output.dir)\npar(mfrow = c(4, 4))\nlapply(c(3,5:ncol(clinic.data)),function(x) boxplot.class.mc(data=clinic.data,x,type=\"t\",class=lw.classified.adbmifma.t0[,4],xlab=\"Risk (0=low, 1=high)\",outfile=outfile))\ndev.off()\n\n\n\n\n\n\n\n\n\n\npdf(sprintf(\"%s/lw_t0_Waist_vs_Fat-mass_Height2_mwu-test_boxplot.pdf\",output.dir))\noutfile=sprintf(\"%s/lw_t0_Waist_vs_Fat-mass_Height2_mwu-test.csv\",output.dir)\npar(mfrow = c(4, 4))\nlapply(c(3,5:ncol(clinic.data)),function(x) boxplot.class.mc(data=clinic.data,x,type=\"mwu\",class=lw.classified.wfmh2.t0[,4],xlab=\"Risk (0=low, 1=high)\",outfile=outfile))\ndev.off()\n\n\n\npdf(sprintf(\"%s/lw_t0_Adipocyte-diameter_vs_Fat-mass_mwu-test_boxplot.pdf\",output.dir))\noutfile<-sprintf(\"%s/lw_t0_Adipocyte-diameter_vs_Fat-mass_mwu-test.csv\",output.dir)\npar(mfrow = c(4, 4))\nlapply(c(3,5:ncol(clinic.data)),function(x) boxplot.class.mc(data=clinic.data,x,type=\"mwu\",class=lw.classified.adfm.t0[,4],xlab=\"Risk (0=low, 1=high)\",outfile=outfile))\ndev.off()\n\n\n\npdf(sprintf(\"%s/lw_t0_Adipocyte-diameter_vs_Waist_Height2_mwu-test_boxplot.pdf\",output.dir))\noutfile<-sprintf(\"%s/lw_t0_Adipocyte-diameter_vs_Waist_Height2_mwu-test.csv\",output.dir)\npar(mfrow = c(4, 4))\nlapply(c(3,5:ncol(clinic.data)),function(x) boxplot.class.mc(data=clinic.data,x,type=\"mwu\",class=lw.classified.adwh2.t0[,4],xlab=\"Risk (0=low, 1=high)\",outfile=outfile))\ndev.off()\n\n\n\npdf(sprintf(\"%s/lw_t0_Adipocyte-diameter_vs_Fat-mass_Height2_mwu-test_boxplot.pdf\",output.dir))\noutfile<-sprintf(\"%s/lw_t0_Adipocyte-diameter_vs_Fat-mass_Height2_mwu-test.csv\",output.dir)\npar(mfrow = c(4, 4))\nlapply(c(3,5:ncol(clinic.data)),function(x) boxplot.class.mc(data=clinic.data,x,type=\"mwu\",class=lw.classified.adfmh2.t0[,4],xlab=\"Risk (0=low, 1=high)\",outfile=outfile))\ndev.off()\n\n\n\n\n\n\n\n\n\n\n\n\npdf(sprintf(\"%s/lw_t0_Waist_vs_Fat-mass_Height2_auto-test_boxplot.pdf\",output.dir))\noutfile=sprintf(\"%s/lw_t0_Waist_vs_Fat-mass_Height2_auto-test.csv\",output.dir)\npar(mfrow = c(4, 4))\nlapply(c(3,5:ncol(clinic.data)),function(x) boxplot.class.mc(data=clinic.data,x,type=\"auto\",class=lw.classified.wfmh2.t0[,4],xlab=\"Risk (0=low, 1=high)\",outfile=outfile))\ndev.off()\n\n\n\npdf(sprintf(\"%s/lw_t0_Adipocyte-diameter_vs_Fat-mass_auto-test_boxplot.pdf\",output.dir))\noutfile<-sprintf(\"%s/lw_t0_Adipocyte-diameter_vs_Fat-mass_auto-test.csv\",output.dir)\npar(mfrow = c(4, 4))\nlapply(c(3,5:ncol(clinic.data)),function(x) boxplot.class.mc(data=clinic.data,x,type=\"auto\",class=lw.classified.adfm.t0[,4],xlab=\"Risk (0=low, 1=high)\",outfile=outfile))\ndev.off()\n\n\n\npdf(sprintf(\"%s/lw_t0_Adipocyte-diameter_vs_Waist_Height2_auto-test_boxplot.pdf\",output.dir))\noutfile<-sprintf(\"%s/lw_t0_Adipocyte-diameter_vs_Waist_Height2_auto-test.csv\",output.dir)\npar(mfrow = c(4, 4))\nlapply(c(3,5:ncol(clinic.data)),function(x) boxplot.class.mc(data=clinic.data,x,type=\"auto\",class=lw.classified.adwh2.t0[,4],xlab=\"Risk (0=low, 1=high)\",outfile=outfile))\ndev.off()\n\n\n\npdf(sprintf(\"%s/lw_t0_Adipocyte-diameter_vs_Fat-mass_Height2_auto-test_boxplot.pdf\",output.dir))\noutfile<-sprintf(\"%s/lw_t0_Adipocyte-diameter_vs_Fat-mass_Height2_auto-test.csv\",output.dir)\npar(mfrow = c(4, 4))\nlapply(c(3,5:ncol(clinic.data)),function(x) boxplot.class.mc(data=clinic.data,x,type=\"auto\",class=lw.classified.adfmh2.t0[,4],xlab=\"Risk (0=low, 1=high)\",outfile=outfile))\ndev.off()\n\n\npdf(sprintf(\"%s/lw_t0_Adipocyte-diameter_vs_Height2_auto-test_boxplot.pdf\",output.dir))\noutfile<-sprintf(\"%s/lw_t0_Adipocyte-diameter_vs_Height2_auto-test.csv\",output.dir)\npar(mfrow = c(4, 4))\nlapply(c(3,5:ncol(clinic.data)),function(x) boxplot.class.mc(data=clinic.data,x,type=\"auto\",class=lw.classified.adh2.t0[,4],xlab=\"Risk (0=low, 1=high)\",outfile=outfile))\ndev.off()\n\n\n\npdf(sprintf(\"%s/lw_t0_Adipocyte-diameter_vs_BMI-Fat-mass-Age_auto-test_boxplot.pdf\",output.dir))\noutfile<-sprintf(\"%s/lw_t0_Adipocyte-diameter_vs_BMI-Fat-mass-Age_auto-test.csv\",output.dir)\npar(mfrow = c(4, 4))\nlapply(c(3,5:ncol(clinic.data)),function(x) boxplot.class.mc(data=clinic.data,x,type=\"auto\",class=lw.classified.adbmifma.t0[,4],xlab=\"Risk (0=low, 1=high)\",outfile=outfile))\ndev.off()\n\n\n\n\n\n\n\n\n\n\n\n\n\n#######################\n# GENE EXPRESSION     #\n#######################\n\n\n#ge.data.t0.nona<-na.omit(ge.data.t0)\nn.na<-sapply(1:ncol(ge.data.t0),function(x) sum(is.na(ge.data.t0[,x]))) \nge.data.t0.nona<-ge.data.t0[,which(n.na==0)]\n\n########################################################\n# BOXPLOT FOR CLASSIFIED GROUPS WITH LINEAR REGRESSION #\n########################################################\n\nge.lm.classified.wfmh2.t0<-read.csv(sprintf(\"%s/ge-nona_lm_t0_Waist_vs_Fat-mass_Height2_points.csv\",output.dir))\nge.lm.classified.adfm.t0<-read.csv(sprintf(\"%s/ge-nona_lm_t0_Adipocyte-diameter_vs_Fat-mass_points.csv\",output.dir))\nge.lm.classified.adwh2.t0<-read.csv(sprintf(\"%s/ge-nona_lm_t0_Adipocyte-diameter_vs_Waist_Height2_points.csv\",output.dir))\nge.lm.classified.adfmh2.t0<-read.csv(sprintf(\"%s/ge-nona_lm_t0_Adipocyte-diameter_vs_Fat-mass_Height2_points.csv\",output.dir))\nge.lm.classified.adh2.t0<-read.csv(sprintf(\"%s/ge-nona_lm_t0_Adipocyte-diameter_vs_Height2_points.csv\",output.dir))\n\nge.lm.classified.adbmifma.t0<-read.csv(sprintf(\"%s/ge-nona_lm_t0_Adipocyte-diameter_vs_BMI-Fat-mass-Age_points.csv\",output.dir))\n\n\n\npdf(sprintf(\"%s/ge-nona_lm_t0_Waist_vs_Fat-mass_Height2_t-test_boxplot.pdf\",output.dir))\noutfile=sprintf(\"%s/ge-nona_lm_t0_Waist_vs_Fat-mass_Height2_t-test.csv\",output.dir)\npar(mfrow = c(4, 4))\nlapply(1:ncol(ge.data.t0.nona),function(x) boxplot.class.mc(data=ge.data.t0.nona,x,type=\"t\",class=ge.lm.classified.wfmh2.t0[,4],xlab=\"Risk (0=low, 1=high)\",outfile=outfile))\ndev.off()\n\n\n\npdf(sprintf(\"%s/ge-nona_lm_t0_Adipocyte-diameter_vs_Fat-mass_t-test_boxplot.pdf\",output.dir))\noutfile<-sprintf(\"%s/ge-nona_lm_t0_Adipocyte-diameter_vs_Fat-mass_t-test.csv\",output.dir)\npar(mfrow = c(4, 4))\nlapply(1:ncol(ge.data.t0.nona),function(x) boxplot.class.mc(data=ge.data.t0.nona,x,type=\"t\",class=ge.lm.classified.adfm.t0[,4],xlab=\"Risk (0=low, 1=high)\",outfile=outfile))\ndev.off()\n\n\n\npdf(sprintf(\"%s/ge-nona_lm_t0_Adipocyte-diameter_vs_Waist_Height2_t-test_boxplot.pdf\",output.dir))\noutfile<-sprintf(\"%s/ge-nona_lm_t0_Adipocyte-diameter_vs_Waist_Height2_t-test.csv\",output.dir)\npar(mfrow = c(4, 4))\nlapply(1:ncol(ge.data.t0.nona),function(x) boxplot.class.mc(data=ge.data.t0.nona,x,type=\"t\",class=ge.lm.classified.adwh2.t0[,4],xlab=\"Risk (0=low, 1=high)\",outfile=outfile))\ndev.off()\n\n\n\npdf(sprintf(\"%s/ge-nona_lm_t0_Adipocyte-diameter_vs_Fat-mass_Height2_t-test_boxplot.pdf\",output.dir))\noutfile<-sprintf(\"%s/ge-nona_lm_t0_Adipocyte-diameter_vs_Fat-mass_Height2_t-test.csv\",output.dir)\npar(mfrow = c(4, 4))\nlapply(1:ncol(ge.data.t0.nona),function(x) boxplot.class.mc(data=ge.data.t0.nona,x,type=\"t\",class=ge.lm.classified.adfmh2.t0[,4],xlab=\"Risk (0=low, 1=high)\",outfile=outfile))\ndev.off()\n\n\n\n\n\n\n\n\n\n\n\npdf(sprintf(\"%s/ge-nona_lm_t0_Waist_vs_Fat-mass_Height2_mwu-test_boxplot.pdf\",output.dir))\noutfile=sprintf(\"%s/ge-nona_lm_t0_Waist_vs_Fat-mass_Height2_mwu-test.csv\",output.dir)\npar(mfrow = c(4, 4))\nlapply(1:ncol(ge.data.t0.nona),function(x) boxplot.class.mc(data=ge.data.t0.nona,x,type=\"mwu\",class=ge.lm.classified.wfmh2.t0[,4],xlab=\"Risk (0=low, 1=high)\",outfile=outfile))\ndev.off()\n\n\n\npdf(sprintf(\"%s/ge-nona_lm_t0_Adipocyte-diameter_vs_Fat-mass_mwu-test_boxplot.pdf\",output.dir))\noutfile<-sprintf(\"%s/ge-nona_lm_t0_Adipocyte-diameter_vs_Fat-mass_mwu-test.csv\",output.dir)\npar(mfrow = c(4, 4))\nlapply(1:ncol(ge.data.t0.nona),function(x) boxplot.class.mc(data=ge.data.t0.nona,x,type=\"mwu\",class=ge.lm.classified.adfm.t0[,4],xlab=\"Risk (0=low, 1=high)\",outfile=outfile))\ndev.off()\n\n\n\npdf(sprintf(\"%s/ge-nona_lm_t0_Adipocyte-diameter_vs_Waist_Height2_mwu-test_boxplot.pdf\",output.dir))\noutfile<-sprintf(\"%s/ge-nona_lm_t0_Adipocyte-diameter_vs_Waist_Height2_mwu-test.csv\",output.dir)\npar(mfrow = c(4, 4))\nlapply(1:ncol(ge.data.t0.nona),function(x) boxplot.class.mc(data=ge.data.t0.nona,x,type=\"mwu\",class=ge.lm.classified.adwh2.t0[,4],xlab=\"Risk (0=low, 1=high)\",outfile=outfile))\ndev.off()\n\n\n\npdf(sprintf(\"%s/ge-nona_lm_t0_Adipocyte-diameter_vs_Fat-mass_Height2_mwu-test_boxplot.pdf\",output.dir))\noutfile<-sprintf(\"%s/ge-nona_lm_t0_Adipocyte-diameter_vs_Fat-mass_Height2_mwu-test.csv\",output.dir)\npar(mfrow = c(4, 4))\nlapply(1:ncol(ge.data.t0.nona),function(x) boxplot.class.mc(data=ge.data.t0.nona,x,type=\"mwu\",class=ge.lm.classified.adfmh2.t0[,4],xlab=\"Risk (0=low, 1=high)\",outfile=outfile))\ndev.off()\n\n\n\n\n\n\n\n\n\n\n\n\npdf(sprintf(\"%s/ge-nona_lm_t0_Waist_vs_Fat-mass_Height2_auto-test_boxplot.pdf\",output.dir))\noutfile=sprintf(\"%s/ge-nona_lm_t0_Waist_vs_Fat-mass_Height2_auto-test.csv\",output.dir)\npar(mfrow = c(4, 4))\nlapply(1:ncol(ge.data.t0.nona),function(x) boxplot.class.mc(data=ge.data.t0.nona,x,type=\"auto\",class=ge.lm.classified.wfmh2.t0[,4],xlab=\"Risk (0=low, 1=high)\",outfile=outfile))\ndev.off()\n\n\n\npdf(sprintf(\"%s/ge-nona_lm_t0_Adipocyte-diameter_vs_Fat-mass_auto-test_boxplot.pdf\",output.dir))\noutfile<-sprintf(\"%s/ge-nona_lm_t0_Adipocyte-diameter_vs_Fat-mass_auto-test.csv\",output.dir)\npar(mfrow = c(4, 4))\nlapply(1:ncol(ge.data.t0.nona),function(x) boxplot.class.mc(data=ge.data.t0.nona,x,type=\"auto\",class=ge.lm.classified.adfm.t0[,4],xlab=\"Risk (0=low, 1=high)\",outfile=outfile))\ndev.off()\n\n\n\npdf(sprintf(\"%s/ge-nona_lm_t0_Adipocyte-diameter_vs_Waist_Height2_auto-test_boxplot.pdf\",output.dir))\noutfile<-sprintf(\"%s/ge-nona_lm_t0_Adipocyte-diameter_vs_Waist_Height2_auto-test.csv\",output.dir)\npar(mfrow = c(4, 4))\nlapply(1:ncol(ge.data.t0.nona),function(x) boxplot.class.mc(data=ge.data.t0.nona,x,type=\"auto\",class=ge.lm.classified.adwh2.t0[,4],xlab=\"Risk (0=low, 1=high)\",outfile=outfile))\ndev.off()\n\n\n\npdf(sprintf(\"%s/ge-nona_lm_t0_Adipocyte-diameter_vs_Fat-mass_Height2_auto-test_boxplot.pdf\",output.dir))\noutfile<-sprintf(\"%s/ge-nona_lm_t0_Adipocyte-diameter_vs_Fat-mass_Height2_auto-test.csv\",output.dir)\npar(mfrow = c(4, 4))\nlapply(1:ncol(ge.data.t0.nona),function(x) boxplot.class.mc(data=ge.data.t0.nona,x,type=\"auto\",class=ge.lm.classified.adfmh2.t0[,4],xlab=\"Risk (0=low, 1=high)\",outfile=outfile))\ndev.off()\n\n\n\npdf(sprintf(\"%s/ge-nona_lm_t0_Adipocyte-diameter_vs_Height2_auto-test_boxplot.pdf\",output.dir))\noutfile<-sprintf(\"%s/ge-nona_lm_t0_Adipocyte-diameter_vs_Height2_auto-test.csv\",output.dir)\npar(mfrow = c(4, 4))\nlapply(1:ncol(ge.data.t0.nona),function(x) boxplot.class.mc(data=ge.data.t0.nona,x,type=\"auto\",class=ge.lm.classified.adh2.t0[,4],xlab=\"Risk (0=low, 1=high)\",outfile=outfile))\ndev.off()\n\n\n\n\npdf(sprintf(\"%s/ge-nona_lm_t0_Adipocyte-diameter_vs_BMI-Fat-mass-Age_auto-test_boxplot.pdf\",output.dir))\noutfile<-sprintf(\"%s/ge-nona_lm_t0_Adipocyte-diameter_vs_BMI-Fat-mass-Age_auto-test.csv\",output.dir)\npar(mfrow = c(4, 4))\nlapply(1:ncol(ge.data.t0.nona),function(x) boxplot.class.mc(data=ge.data.t0.nona,x,type=\"auto\",class=ge.lm.classified.adbmifma.t0[,4],xlab=\"Risk (0=low, 1=high)\",outfile=outfile))\ndev.off()\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n########################################################\n# BOXPLOT FOR CLASSIFIED GROUPS WITH LOWESS REGRESSION #\n########################################################\n\n\nge.lw.classified.wfmh2.t0<-read.csv(sprintf(\"%s/ge-nona_lw_t0_Waist_vs_Fat-mass_Height2_points.csv\",output.dir))\nge.lw.classified.adfm.t0<-read.csv(sprintf(\"%s/ge-nona_lw_t0_Adipocyte-diameter_vs_Fat-mass_points.csv\",output.dir))\nge.lw.classified.adwh2.t0<-read.csv(sprintf(\"%s/ge-nona_lw_t0_Adipocyte-diameter_vs_Waist_Height2_points.csv\",output.dir))\nge.lw.classified.adfmh2.t0<-read.csv(sprintf(\"%s/ge-nona_lw_t0_Adipocyte-diameter_vs_Fat-mass_Height2_points.csv\",output.dir))\nge.lw.classified.adbmifma.t0<-read.csv(sprintf(\"%s/ge-nona_lw_t0_Adipocyte-diameter_vs_BMI-Fat-mass-Age_points.csv\",output.dir))\n\n\npdf(sprintf(\"%s/ge-nona_lw_t0_Waist_vs_Fat-mass_Height2_t-test_boxplot.pdf\",output.dir))\noutfile=sprintf(\"%s/ge-nona_lw_t0_Waist_vs_Fat-mass_Height2_t-test.csv\",output.dir)\npar(mfrow = c(4, 4))\nlapply(203:205,function(x) boxplot.class.mc(data=ge.data.t0,x,type=\"t\",class=as.factor(ge.lw.classified.wfmh2.t0[,4]),xlab=\"Risk (0=low, 1=high)\",outfile=outfile))\ndev.off()\n\n\n\npdf(sprintf(\"%s/ge-nona_lw_t0_Adipocyte-diameter_vs_Fat-mass_t-test_boxplot.pdf\",output.dir))\noutfile<-sprintf(\"%s/ge-nona_lw_t0_Adipocyte-diameter_vs_Fat-mass_t-test.csv\",output.dir)\npar(mfrow = c(4, 4))\nlapply(1:ncol(ge.data.t0.nona),function(x) boxplot.class.mc(data=ge.data.t0.nona,x,type=\"t\",class=ge.lw.classified.adfm.t0[,4],xlab=\"Risk (0=low, 1=high)\",outfile=outfile))\ndev.off()\n\n\n\npdf(sprintf(\"%s/ge-nona_lw_t0_Adipocyte-diameter_vs_Waist_Height2_t-test_boxplot.pdf\",output.dir))\noutfile<-sprintf(\"%s/ge-nona_lw_t0_Adipocyte-diameter_vs_Waist_Height2_t-test.csv\",output.dir)\npar(mfrow = c(4, 4))\nlapply(1:ncol(ge.data.t0.nona),function(x) boxplot.class.mc(data=ge.data.t0.nona,x,type=\"t\",class=ge.lw.classified.adwh2.t0[,4],xlab=\"Risk (0=low, 1=high)\",outfile=outfile))\ndev.off()\n\n\n\npdf(sprintf(\"%s/ge-nona_lw_t0_Adipocyte-diameter_vs_Fat-mass_Height2_t-test_boxplot.pdf\",output.dir))\noutfile<-sprintf(\"%s/ge-nona_lw_t0_Adipocyte-diameter_vs_Fat-mass_Height2_t-test.csv\",output.dir)\npar(mfrow = c(4, 4))\nlapply(1:ncol(ge.data.t0.nona),function(x) boxplot.class.mc(data=ge.data.t0.nona,x,type=\"t\",class=ge.lw.classified.adfmh2.t0[,4],xlab=\"Risk (0=low, 1=high)\",outfile=outfile))\ndev.off()\n\n\n#03/07/2013\npdf(sprintf(\"%s/ge-nona_lw_t0_Adipocyte-diameter_vs_Height2_auto-test_boxplot.pdf\",output.dir))\noutfile<-sprintf(\"%s/ge-nona_lw_t0_Adipocyte-diameter_vs_Height2_auto-test.csv\",output.dir)\npar(mfrow = c(4, 4))\nlapply(1:ncol(ge.data.t0.nona),function(x) boxplot.class.mc(data=ge.data.t0.nona,x,type=\"auto\",class=ge.lw.classified.adh2.t0[,4],xlab=\"Risk (0=low, 1=high)\",outfile=outfile))\ndev.off()\n\n\n\npdf(sprintf(\"%s/ge-nona_lw_t0_Adipocyte-diameter_vs_BMI-Fat-mass-Age_t-test_boxplot.pdf\",output.dir))\noutfile<-sprintf(\"%s/ge-nona_lw_t0_Adipocyte-diameter_vs_BMI-Fat-mass-Age_t-test.csv\",output.dir)\npar(mfrow = c(4, 4))\nlapply(1:ncol(ge.data.t0.nona),function(x) boxplot.class.mc(data=ge.data.t0.nona,x,type=\"t\",class=ge.lw.classified.adbmifma.t0[,4],xlab=\"Risk (0=low, 1=high)\",outfile=outfile))\ndev.off()\n\n\n\n\n\n\n\n\n\npdf(sprintf(\"%s/ge-nona_lw_t0_Waist_vs_Fat-mass_Height2_mwu-test_boxplot.pdf\",output.dir))\noutfile=sprintf(\"%s/ge-nona_lw_t0_Waist_vs_Fat-mass_Height2_mwu-test.csv\",output.dir)\npar(mfrow = c(4, 4))\nlapply(1:ncol(ge.data.t0.nona),function(x) boxplot.class.mc(data=ge.data.t0.nona,x,type=\"mwu\",class=ge.lw.classified.wfmh2.t0[,4],xlab=\"Risk (0=low, 1=high)\",outfile=outfile))\ndev.off()\n\n\n\npdf(sprintf(\"%s/ge-nona_lw_t0_Adipocyte-diameter_vs_Fat-mass_mwu-test_boxplot.pdf\",output.dir))\noutfile<-sprintf(\"%s/ge-nona_lw_t0_Adipocyte-diameter_vs_Fat-mass_mwu-test.csv\",output.dir)\npar(mfrow = c(4, 4))\nlapply(1:ncol(ge.data.t0.nona),function(x) boxplot.class.mc(data=ge.data.t0.nona,x,type=\"mwu\",class=ge.lw.classified.adfm.t0[,4],xlab=\"Risk (0=low, 1=high)\",outfile=outfile))\ndev.off()\n\n\n\npdf(sprintf(\"%s/ge-nona_lw_t0_Adipocyte-diameter_vs_Waist_Height2_mwu-test_boxplot.pdf\",output.dir))\noutfile<-sprintf(\"%s/ge-nona_lw_t0_Adipocyte-diameter_vs_Waist_Height2_mwu-test.csv\",output.dir)\npar(mfrow = c(4, 4))\nlapply(1:ncol(ge.data.t0.nona),function(x) boxplot.class.mc(data=ge.data.t0.nona,x,type=\"mwu\",class=ge.lw.classified.adwh2.t0[,4],xlab=\"Risk (0=low, 1=high)\",outfile=outfile))\ndev.off()\n\n\n\npdf(sprintf(\"%s/ge-nona_lw_t0_Adipocyte-diameter_vs_Fat-mass_Height2_mwu-test_boxplot.pdf\",output.dir))\noutfile<-sprintf(\"%s/ge-nona_lw_t0_Adipocyte-diameter_vs_Fat-mass_Height2_mwu-test.csv\",output.dir)\npar(mfrow = c(4, 4))\nlapply(1:ncol(ge.data.t0.nona),function(x) boxplot.class.mc(data=ge.data.t0.nona,x,type=\"mwu\",class=ge.lw.classified.adfmh2.t0[,4],xlab=\"Risk (0=low, 1=high)\",outfile=outfile))\ndev.off()\n\n\n\n\n\n\n\n\n\n\n\n\npdf(sprintf(\"%s/ge-nona_lw_t0_Waist_vs_Fat-mass_Height2_auto-test_boxplot.pdf\",output.dir))\noutfile=sprintf(\"%s/ge-nona_lw_t0_Waist_vs_Fat-mass_Height2_auto-test.csv\",output.dir)\npar(mfrow = c(4, 4))\nlapply(1:ncol(ge.data.t0.nona),function(x) boxplot.class.mc(data=ge.data.t0.nona,x,type=\"auto\",class=ge.lw.classified.wfmh2.t0[,4],xlab=\"Risk (0=low, 1=high)\",outfile=outfile))\ndev.off()\n\n\n\npdf(sprintf(\"%s/ge-nona_lw_t0_Adipocyte-diameter_vs_Fat-mass_auto-test_boxplot.pdf\",output.dir))\noutfile<-sprintf(\"%s/ge-nona_lw_t0_Adipocyte-diameter_vs_Fat-mass_auto-test.csv\",output.dir)\npar(mfrow = c(4, 4))\nlapply(1:ncol(ge.data.t0.nona),function(x) boxplot.class.mc(data=ge.data.t0.nona,x,type=\"auto\",class=ge.lw.classified.adfm.t0[,4],xlab=\"Risk (0=low, 1=high)\",outfile=outfile))\ndev.off()\n\n\n\npdf(sprintf(\"%s/ge-nona_lw_t0_Adipocyte-diameter_vs_Waist_Height2_auto-test_boxplot.pdf\",output.dir))\noutfile<-sprintf(\"%s/ge-nona_lw_t0_Adipocyte-diameter_vs_Waist_Height2_auto-test.csv\",output.dir)\npar(mfrow = c(4, 4))\nlapply(1:ncol(ge.data.t0.nona),function(x) boxplot.class.mc(data=ge.data.t0.nona,x,type=\"auto\",class=ge.lw.classified.adwh2.t0[,4],xlab=\"Risk (0=low, 1=high)\",outfile=outfile))\ndev.off()\n\n\n\npdf(sprintf(\"%s/ge-nona_lw_t0_Adipocyte-diameter_vs_Fat-mass_Height2_auto-test_boxplot.pdf\",output.dir))\noutfile<-sprintf(\"%s/ge-nona_lw_t0_Adipocyte-diameter_vs_Fat-mass_Height2_auto-test.csv\",output.dir)\npar(mfrow = c(4, 4))\nlapply(1:ncol(ge.data.t0.nona),function(x) boxplot.class.mc(data=ge.data.t0.nona,x,type=\"auto\",class=ge.lw.classified.adfmh2.t0[,4],xlab=\"Risk (0=low, 1=high)\",outfile=outfile))\ndev.off()\n\n\npdf(sprintf(\"%s/ge-nona_lw_t0_Adipocyte-diameter_vs_BMI-Fat-mass-Age_auto-test_boxplot.pdf\",output.dir))\noutfile<-sprintf(\"%s/ge-nona_lw_t0_Adipocyte-diameter_vs_BMI-Fat-mass-Age_auto-test.csv\",output.dir)\npar(mfrow = c(4, 4))\nlapply(1:ncol(ge.data.t0.nona),function(x) boxplot.class.mc(data=ge.data.t0.nona,x,type=\"auto\",class=ge.lw.classified.adbmifma.t0[,4],xlab=\"Risk (0=low, 1=high)\",outfile=outfile))\ndev.off()\n\n\n\n\n\ndata<-clinic.data[,-c(1,2,4)]\n\nplot(data[,1],data[,3])\n\nle<-loess(data[,3]~data[,1])\ny.predict<-predict(le,data[,3])\n\nplot(data[,3],fitted(le))\n\n\nncol(data)\n\n\nx<-fitted(loess(clinic.data$BMI_clin_kg.per.m~clinic.data$fatmass_clin_kg))\n\ny<-fitted(loess(clinic.data$diam_clin_cm~clinic.data$fatmass_clin_kg))\n\nplot(clinic.data$diam_clin_cm,x)\n\nplot(clinic.data$BMI_clin_kg.per.m,clinic.data$fatmass_clin_kg)\n\n\n\n#07/07\n\ngenes.updown<-function(genes,prode.entrez,high,low,stars,fileprefix,output.dir){\n  m<-mean(as.numeric(as.matrix(genes)))\n  res<-as.data.frame(rbind(c(\"Probe_ID\",\"High_Risk_Group\",\"Low_Risk_Group\"),cbind(colnames(genes),ifelse(colMeans(genes[high,])>m,1,0),ifelse(colMeans(genes[low])>m,1,0))))\n  \n  #high.up\n  ge.high.up<-res[rownames(res)%in%stars & res[,2]==1,]\n  high.up<-t(genes[,colnames(genes)%in%as.character(ge.high.up[,1])])\n  rownames(high.up)<-prode.entrez[prode.entrez[,1]%in%rownames(high.up),2]\n  high.up<-high.up[na.omit(rownames(high.up)),]\n  \n  #high.up\n  ge.high.up<-res[rownames(res)%in%stars & res[,2]==1,]\n  high.up<-t(genes[,colnames(genes)%in%as.character(ge.high.up[,1])])\n  rownames(high.up)<-prode.entrez[prode.entrez[,1]%in%rownames(high.up),2]\n  high.up<-high.up[na.omit(rownames(high.up)),]\n  \n  #high.up\n  ge.high.down<-res[rownames(res)%in%stars & res[,2]==0,]\n  high.down<-t(genes[,colnames(genes)%in%as.character(ge.high.down[,1])])\n  rownames(high.down)<-prode.entrez[prode.entrez[,1]%in%rownames(high.down),2]\n  high.down<-high.down[na.omit(rownames(high.down)),]\n  \n  #low.up\n  ge.low.up<-res[rownames(res)%in%stars & res[,3]==1,]\n  low.up<-t(genes[,colnames(genes)%in%as.character(ge.low.up[,1])])\n  rownames(low.up)<-prode.entrez[prode.entrez[,1]%in%rownames(low.up),2]\n  low.up<-low.up[na.omit(rownames(low.up)),]  \n  \n  #low.down\n  ge.low.down<-res[rownames(res)%in%stars & res[,3]==0,]\n  low.down<-t(genes[,colnames(genes)%in%as.character(ge.low.down[,1])])\n  rownames(low.down)<-prode.entrez[prode.entrez[,1]%in%rownames(low.down),2]\n  low.down<-low.down[na.omit(rownames(low.down)),]\n  \n  high.refs<-c(rownames(high.up),rownames(high.down))\n  low.refs<-c(rownames(low.up),rownames(low.down))\n\n  high.up.frame<-as.data.frame(high.up)\n  colnames(high.up.frame)[1]<-\"GeneID\"\n  high.down.frame<-as.data.frame(high.down)\n  colnames(high.down.frame)[1]<-\"GeneID\"\n  \n  low.up.frame<-as.data.frame(low.up)\n  colnames(low.up.frame)[1]<-\"GeneID\"  \n  low.down.frame<-as.data.frame(low.down)\n  colnames(low.down.frame)[1]<-\"GeneID\"\n  \n\n  write.table(high.up,file=sprintf(\"%s/%s.high.up.genes.txt\",output.dir,fileprefix),col.names=F,row.names=T,sep=\"\\t\",quote=F)\n  write.table(high.down,file=sprintf(\"%s/%s.high.down.genes.txt\",output.dir,fileprefix),col.names=F,row.names=T,sep=\"\\t\",quote=F)\n  write.table(low.up,file=sprintf(\"%s/%s.low.up.genes.txt\",output.dir,fileprefix),col.names=F,row.names=T,sep=\"\\t\",quote=F)\n  write.table(low.down,file=sprintf(\"%s/%s.low.down.genes.txt\",output.dir,fileprefix),col.names=F,row.names=T,sep=\"\\t\",quote=F)\n  write.table(high.refs,file=sprintf(\"%s/%s.high.refs.genes.txt\",output.dir,fileprefix),col.names=F,row.names=F,sep=\"\\t\",quote=F)\n  write.table(low.refs,file=sprintf(\"%s/%s.low.refs.genes.txt\",output.dir,fileprefix),col.names=F,row.names=F,sep=\"\\t\",quote=F)\n  write.table(res,file=sprintf(\"%s/updown.genes.%s.txt\",output.dir,fileprefix),col.names=F,row.names=F,sep=\"\\t\",quote=F)\n  \n  \n  high.up.frame<-as.data.frame(read.table(sprintf(\"%s/%s.high.up.genes.txt\",output.dir,fileprefix),sep=\"\\t\",header=F))\n  high.down.frame<-as.data.frame(read.table(sprintf(\"%s/%s.high.down.genes.txt\",output.dir,fileprefix),sep=\"\\t\",header=F))\n  low.up.frame<-as.data.frame(read.table(sprintf(\"%s/%s.low.up.genes.txt\",output.dir,fileprefix),sep=\"\\t\",header=F))\n  low.down.frame<-as.data.frame(read.table(sprintf(\"%s/%s.low.down.genes.txt\",output.dir,fileprefix),sep=\"\\t\",header=F))\n  \n  \n  fun(org=\"HS\", two.lists=TRUE, up.frame=high.up.frame, down.frame=high.down.frame,\n      genes.frame=NULL, restrict=TRUE, ref.list=high.ref.list, logged=FALSE,\n      discriminant=TRUE, go.bp=TRUE, go.cc=TRUE, go.mf=TRUE, kegg=TRUE,\n      annot.method=\"specificity\", annot.details=TRUE,\n      direct=FALSE, enriched=TRUE, fdr=NA, build.annot.net=TRUE,\n      coexp.matrix=NULL, coexp.method=\"spearman\", estimate.th=FALSE,\n      hard.th=0.8, soft.th=NA, topological = FALSE, keep.sign=FALSE, level=1,\n      annot.clust.method=\"umilds\", annot.prox.measure=\"dynamical\",\n      test.recovery=FALSE, test.robust=FALSE, replace.annot=NA,\n      build.gene.net=TRUE, gene.clust.method=\"hclust\", gene.net.details=TRUE,\n      gene.clusters=NA, alpha=0.05, RV=0.90, sigma=NA, keep.rdata=FALSE, zip=TRUE,fileprefix=sprintf(\"%s.high.genes\",fileprefix))\n  \n  fun(org=\"HS\", two.lists=TRUE, up.frame=low.up, down.frame=low.down,\n      genes.frame=NULL, restrict=TRUE, ref.list=prode.entrez[,1], logged=FALSE,\n      discriminant=TRUE, go.bp=TRUE, go.cc=TRUE, go.mf=TRUE, kegg=TRUE,\n      annot.method=\"specificity\", annot.details=TRUE,\n      direct=FALSE, enriched=TRUE, fdr=NA, build.annot.net=TRUE,\n      coexp.matrix=NULL, coexp.method=\"spearman\", estimate.th=FALSE,\n      hard.th=0.8, soft.th=NA, topological = FALSE, keep.sign=FALSE, level=1,\n      annot.clust.method=\"umilds\", annot.prox.measure=\"dynamical\",\n      test.recovery=FALSE, test.robust=FALSE, replace.annot=NA,\n      build.gene.net=TRUE, gene.clust.method=\"hclust\", gene.net.details=TRUE,\n      gene.clusters=NA, alpha=0.05, RV=0.90, sigma=NA, keep.rdata=FALSE, zip=TRUE,fileprefix=sprintf(\"%s.low.genes\",fileprefix))\n\n  \n  return(res)\n}\n\nge.data.t0<-get(load(sprintf(\"%s/GE_t0.RData\",input.dir)))\n\n#ge.data.t0.nona<-na.omit(ge.data.t0)\nn.na<-sapply(1:ncol(ge.data.t0),function(x) sum(is.na(ge.data.t0[,x]))) \nge.data.t0.nona<-ge.data.t0[,which(n.na==0)]\n\nge.lm.classified.adfm.t0<-read.csv(sprintf(\"%s/ge-nona_lm_t0_Adipocyte-diameter_vs_Fat-mass_points.csv\",output.dir))\nge.lm.classified.adwh2.t0<-read.csv(sprintf(\"%s/ge-nona_lm_t0_Adipocyte-diameter_vs_Waist_Height2_points.csv\",output.dir))\nge.lm.classified.adfmh2.t0<-read.csv(sprintf(\"%s/ge-nona_lm_t0_Adipocyte-diameter_vs_Fat-mass_Height2_points.csv\",output.dir))\nge.lm.classified.adh2.t0<-read.csv(sprintf(\"%s/ge-nona_lm_t0_Adipocyte-diameter_vs_Height2_points.csv\",output.dir))\nge.lm.classified.adbmifma.t0<-read.csv(sprintf(\"%s/ge-nona_lm_t0_Adipocyte-diameter_vs_BMI-Fat-mass-Age_points.csv\",output.dir))\n\nge.lm.classified.adfm.t0.autotest<-read.table(sprintf(\"%s/ge-nona_lm_t0_Adipocyte-diameter_vs_Fat-mass_auto-test.csv\",output.dir),sep=\";\")\nge.lm.classified.adwh2.t0.autotest<-read.table(sprintf(\"%s/ge-nona_lm_t0_Adipocyte-diameter_vs_Waist_Height2_auto-test.csv\",output.dir),sep=\";\")\nge.lm.classified.adfmh2.t0.autotest<-read.table(sprintf(\"%s/ge-nona_lm_t0_Adipocyte-diameter_vs_Fat-mass_Height2_auto-test.csv\",output.dir),sep=\";\")\nge.lm.classified.adh2.t0.autotest<-read.table(sprintf(\"%s/ge-nona_lm_t0_Adipocyte-diameter_vs_Height2_auto-test.csv\",output.dir),sep=\";\")\nge.lm.classified.adbmifma.t0.autotest<-read.table(sprintf(\"%s/ge-nona_lm_t0_Adipocyte-diameter_vs_BMI-Fat-mass-Age_auto-test.csv\",output.dir),sep=\";\")\n\nge.lm.classified.adfm.t0.autotest.star<-ge.lm.classified.adfm.t0.autotest[ge.lm.classified.adfm.t0.autotest[,4]!=\"\",]\nge.lm.classified.adwh2.t0.autotest.star<-ge.lm.classified.adwh2.t0.autotest[ge.lm.classified.adwh2.t0.autotest[,4]!=\"\",]\nge.lm.classified.adfmh2.t0.autotest.star<-ge.lm.classified.adfmh2.t0.autotest[ge.lm.classified.adfmh2.t0.autotest[,4]!=\"\",]\nge.lm.classified.adh2.t0.star<-ge.lm.classified.adh2.t0.autotest[ge.lm.classified.adh2.t0.autotest[,4]!=\"\",]\nge.lm.classified.adbmifma.t0.autotest.star<-ge.lm.classified.adbmifma.t0.autotest[ge.lm.classified.adbmifma.t0.autotest[,4]!=\"\",]\n\n\n\n\nge.data<-read.table(sprintf(\"%s/data.d.all.txt\",input.dir),sep=\"\\t\",header=T)\nge.prode.entrez<-ge.data[,2:3]\n\nupdown.genes.ge.lm.classified.wfmh2.t0<-genes.updown(genes=ge.data.t0.nona,\n                                                     prode.entrez=ge.prode.entrez,\n                                                     high=which(ge.lm.classified.adfm.t0[,4]==0),\n                                                     low=which(ge.lm.classified.adfm.t0[,4]==1),\n                                                     stars=ge.lm.classified.adfm.t0.autotest.star[,1],\n                                                     fileprefix=\"ge.lm.classified.adfm.t0\",\n                                                     output.dir=output.dir)\nupdown.genes.ge.lm.classified.adwh2.t0<-genes.updown(genes=ge.data.t0.nona,\n                                                     prode.entrez=ge.prode.entrez,\n                                                     high=which(ge.lm.classified.adwh2.t0[,4]==0),\n                                                     low=which(ge.lm.classified.adwh2.t0[,4]==1),\n                                                     stars=ge.lm.classified.adfm.t0.autotest.star[,1],\n                                                     fileprefix=\"ge.lm.classified.adwh2.t0\",\n                                                     output.dir=output.dir)\nupdown.genes.ge.lm.classified.adfmh2.t0<-genes.updown(genes=ge.data.t0.nona,\n                                                     prode.entrez=ge.prode.entrez,\n                                                     high=which(ge.lm.classified.adfmh2.t0[,4]==0),\n                                                     low=which(ge.lm.classified.adfmh2.t0[,4]==1),\n                                                     stars=ge.lm.classified.adfm.t0.autotest.star[,1],\n                                                     fileprefix=\"ge.lm.classified.adfmh2.t0\",\n                                                     output.dir=output.dir)\nupdown.genes.ge.lm.classified.adh2.t0<-genes.updown(genes=ge.data.t0.nona,\n                                                    prode.entrez=ge.prode.entrez,\n                                                     high=which(ge.lm.classified.adh2.t0[,4]==0),\n                                                     low=which(ge.lm.classified.adh2.t0[,4]==1),\n                                                     stars=ge.lm.classified.adfm.t0.autotest.star[,1],\n                                                     fileprefix=\"ge.lm.classified.adh2.t0\",\n                                                     output.dir=output.dir)\nupdown.genes.ge.lm.classified.adbmifma.t0<-genes.updown(genes=ge.data.t0.nona,\n                                                        prode.entrez=ge.prode.entrez,\n                                                     high=which(ge.lm.classified.adbmifma.t0[,4]==0),\n                                                     low=which(ge.lm.classified.adbmifma.t0[,4]==1),\n                                                     stars=ge.lm.classified.adfm.t0.autotest.star[,1],\n                                                     fileprefix=\"ge.lm.classified.adbmifma.t0\",\n                                                     output.dir=output.dir)\n\n\n\n\nupdown.genes.ge.lm.classified.adfm.t0.autotest.star<-updown.genes.ge.lm.classified.adbmifma.t0[updown.genes.ge.lm.classified.adbmifma.t0[,1]%in%ge.lm.classified.adfm.t0.autotest.star[,1],]\n\n\n\nupdown.genes.ge.lm.classified.adfm.t0.autotest.star<-genes.updown(genes=ge.data.t0.nona[,colnames(ge.data.t0.nona)[which(colnames(ge.data.t0.nona)%in%ge.lm.classified.adfm.t0.autotest.star[,1])]],\n                                                        high=which(ge.lm.classified.adfm.t0[,4]==0),\n                                                        low=which(ge.lm.classified.adfm.t0[,4]==1),\n                                                        filename=sprintf(\"%s/updown.genes.ge.lm.classified.adfm.t0.autotest.star.csv\",output.dir))\n\nupdown.genes.ge.lm.classified.adwh2.t0.autotest.star<-genes.updown(genes=ge.data.t0.nona[,colnames(ge.data.t0.nona)[which(colnames(ge.data.t0.nona)%in%ge.lm.classified.adwh2.t0.autotest.star[,1])]],\n                                                                  high=which(ge.lm.classified.adwh2.t0[,4]==0),\n                                                                  low=which(ge.lm.classified.adwh2.t0[,4]==1),\n                                                                  filename=sprintf(\"%s/updown.genes.ge.lm.classified.adwh2.t0.autotest.star.csv\",output.dir))\n\n\n\nplot(as.numeric(updown.genes.ge.lm.classified.wfmh2.t0[,2]),\n     as.numeric(updown.genes.ge.lm.classified.wfmh2.t0[,3]),\n     xlab=\"Mean expression level of High Risk Group (HRG)\",\n     ylab=\"Mean expression level of Low Risk Group (LRG)\",\n     main=\"Distribution of gene expression level between groups \\n Classification by 'Waist vs Fat mass/Heigth^2'\")\n\nplot(as.numeric(updown.genes.ge.lm.classified.adbmifma.t0[,2]),\n     as.numeric(updown.genes.ge.lm.classified.adbmifma.t0[,3]),\n     xlab=\"Mean expression level of High Risk Group (HRG)\",\n     ylab=\"Mean expression level of Low Risk Group (LRG)\",\n     main=\"Distribution of gene expression level between groups \\n Classification by 'Waist vs Fat mass/Heigth^2'\")\n\n\n\nplot(as.numeric(as.character(updown.genes.ge.lm.classified.adbmifma.t0.autotest.star[,2])),\n     as.numeric(as.character(updown.genes.ge.lm.classified.adbmifma.t0.autotest.star[,3])),\n     xlab=\"Mean expression level of High Risk Group (HRG)\",\n     ylab=\"Mean expression level of Low Risk Group (LRG)\",\n     xlim=c(0,3000),\n     ylim=c(0,3000),\n     main=\"Distribution of gene expression level between groups \\n Classification by 'Waist vs Fat mass/Heigth^2'\")\n\nplot(as.numeric(as.character(ge.lm.classified.adbmifma.t0.autotest.star.not.star[,2])),\n     as.numeric(as.character(ge.lm.classified.adbmifma.t0.autotest.star.not.star[,3])),\n     xlab=\"Mean expression level of High Risk Group (HRG)\",\n     ylab=\"Mean expression level of Low Risk Group (LRG)\",\n     xlim=c(0,3000),\n     ylim=c(0,3000),\n     main=\"Distribution of gene expression level between groups \\n Classification by 'Waist vs Fat mass/Heigth^2'\")\n\n\n\n\nhigh.ref.list<-read.table(sprintf(\"%s/Entrez_Gene_ID.csv\",input.dir),sep=\"\\t\",header=F)\nhigh.ref.list<-data.frame(high.ref.list)\nrownames(high.ref.list)<-high.ref.list[,1]\n\nhigh.up.frame<-as.data.frame(read.table(sprintf(\"%s/ge.lm.classified.adfm.t0.highup.genes.txt\",output.dir),sep=\"\\t\",header=F))\nhigh.down.frame<-as.data.frame(read.table(sprintf(\"%s/ge.lm.classified.adfm.t0.highdown.genes.txt\",output.dir),sep=\"\\t\",header=F))\n\n\nfun(org=\"HS\", two.lists=TRUE, up.frame=high.up.frame, down.frame=high.down.frame,\n    genes.frame=NULL, restrict=TRUE, ref.list=high.ref.list, logged=FALSE,\n    discriminant=TRUE, go.bp=TRUE, go.cc=TRUE, go.mf=TRUE, kegg=TRUE,\n    annot.method=\"specificity\", annot.details=TRUE,\n    direct=FALSE, enriched=TRUE, fdr=NA, build.annot.net=TRUE,\n    coexp.matrix=NULL, coexp.method=\"spearman\", estimate.th=FALSE,\n    hard.th=0.8, soft.th=NA, topological = FALSE, keep.sign=FALSE, level=1,\n    annot.clust.method=\"umilds\", annot.prox.measure=\"dynamical\",\n    test.recovery=FALSE, test.robust=FALSE, replace.annot=NA,\n    build.gene.net=TRUE, gene.clust.method=\"hclust\", gene.net.details=TRUE,\n    gene.clusters=NA, alpha=0.05, RV=0.90, sigma=NA, keep.rdata=FALSE, zip=TRUE,fileprefix=sprintf(\"%s/%s.high.genes\",output.dir,\"ge.lm.classified.adfm.t0\"))\n\nfun(org=\"HS\", two.lists=TRUE, up.frame=low.up, down.frame=low.down,\n    genes.frame=NULL, restrict=TRUE, ref.list=prode.entrez[,1], logged=FALSE,\n    discriminant=TRUE, go.bp=TRUE, go.cc=TRUE, go.mf=TRUE, kegg=TRUE,\n    annot.method=\"specificity\", annot.details=TRUE,\n    direct=FALSE, enriched=TRUE, fdr=NA, build.annot.net=TRUE,\n    coexp.matrix=NULL, coexp.method=\"spearman\", estimate.th=FALSE,\n    hard.th=0.8, soft.th=NA, topological = FALSE, keep.sign=FALSE, level=1,\n    annot.clust.method=\"umilds\", annot.prox.measure=\"dynamical\",\n    test.recovery=FALSE, test.robust=FALSE, replace.annot=NA,\n    build.gene.net=TRUE, gene.clust.method=\"hclust\", gene.net.details=TRUE,\n    gene.clusters=NA, alpha=0.05, RV=0.90, sigma=NA, keep.rdata=FALSE, zip=TRUE,fileprefix=sprintf(\"%s/%s.low.genes\",output.dir,\"ge.lm.classified.adfm.t0\"))\n\n",
    "created" : 1374054567805.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3155165712",
    "id" : "F495FEE4",
    "lastKnownWriteTime" : 1374158097,
    "path" : "~/metacardis/7.scripts/released/svn/mc-r/trunk/classifySubjects.R",
    "properties" : {
    },
    "source_on_save" : false,
    "type" : "r_source"
}